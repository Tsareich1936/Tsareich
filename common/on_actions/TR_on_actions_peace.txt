on_actions = {
	on_capitulation_immediate = {#debug
		effect = {#debug
			if = {
				limit = {
					has_global_flag = TR_debug_war
					# ROOT = {
					# 	tag = HOL
					# }
					# FROM = {
					# 	tag = GER
					# }
				}
				ROOT = {
					white_peace = {
						tag = FROM
						message = localization_key
					}
					every_owned_state = {
						every_country = {
							limit = {
								has_war_with = ROOT
								PREV = {
									is_controlled_by = PREV
								}
							}
							transfer_state = PREV
						}
					}
				}
				FROM = {
					annex_country = {
						target = ROOT
					}
				}
			}
		}
	}
	on_capitulation_immediate = {
		effect = {#JAP-KOR war peace
			if = {
				limit = {
					ROOT = {
						tag = KOR
					}
					FROM = {
						tag = JAP
					}
					has_global_flag = JAP_KOREA_WAR
					not = {
						has_global_flag = JAP_KOREA_WAR_FINISHED
					}
				}
				FROM = {
					white_peace = {
						tag = ROOT
						message = localization_key
					}
				}
				set_global_flag = JAP_KOREA_WAR_FINISHED
				JAP = {
					country_event = {
						id = TR_japan.71
					}
				}
			}
		}
		effect = {# SRI-CRO war peace
			if = {
				limit = {
					ROOT = {
						tag = CRO
					}
					FROM = {
						OR = {
							tag = SRI
							tag = GER
							tag = FRA
						}
					}
					SRI = {
						has_country_flag = {
							flag = TR_SRI_socialist_zara_war_flag
							value = 1
						}
					}
				}
				set_country_flag = {
					flag = TR_SRI_socialist_zara_war_flag
					value = 2
				}
				SRI = {
					transfer_state = 103
					transfer_state = 163
					country_event = {
						id = TR_north_italy.socialism.12
						days = 3
					}
				}
				if = {
					limit = {
						GER = {
							has_war_with = CRO
						}
					}
					every_country = {
						limit = {
							has_war_with = CRO
						}
						white_peace = {
							tag = CRO
							message = TR_SRI_CRO_WAR_finished_1
						}
					}
					SLV = {
						transfer_state = 102
						transfer_state = 853
						GER = {
							set_autonomy = {
								target = SLV
								autonomy_state = autonomy_puppet
							}
						}
					}
					CRO = {
						transfer_state = 109
						SRI = {
							set_autonomy = {
								target = CRO
								autonomy_state = autonomy_puppet
							}
						}
					}
				}
				if = {
					limit = {
						NOT = {
							GER = {
								has_war_with = CRO
							}
						}
					}
					every_country = {
						limit = {
							has_war_with = CRO
						}
						white_peace = {
							tag = CRO
							message = TR_SRI_CRO_WAR_finished_2
						}
					}
					SLV = {
						transfer_state = 102
						transfer_state = 853
						SRI = {
							set_autonomy = {
								target = SLV
								autonomy_state = autonomy_puppet
							}
						}
					}
					CRO = {
						transfer_state = 109
						SRI = {
							set_autonomy = {
								target = CRO
								autonomy_state = autonomy_puppet
							}
						}
					}
				}
				CRO = {
					set_capital = {
						state = 109
						remember_old_capital = no
					}
					every_owned_state = {
						set_state_controller_to = CRO
					}
				}
				SER = {
					country_event = {
						id = TR_north_italy.socialism.22
						days = 1
					}
				}
			}
		}
		effect = {#Balkan War peace
			if = {
				limit = {
					ROOT = {
						OR = {
							tag = HUN
							AND = {
								tag = BUL
							}							
						}
					}
					FROM = {
						OR = {
							tag	= SER
							tag = ROM
							tag = CZE
						}
					}
					has_global_flag = TR_balkan_war
					NOT = {
						has_global_flag = TR_balkan_war_finished
					}
				}
				FROM = {
					
				}
				set_global_flag = TR_balkan_war_finished
				TR_SER_balkan_war_peace = yes
			}
		}
		effect = {#US civil war
			if = {
				limit = {
					ROOT = {
						OR = {
							original_tag = USA
							tag = TXS
							tag = DST
							tag = IRC
						}
					}
					FROM = {
						OR = {
							original_tag = USA
							tag = TXS
							tag = DST
							tag = IRC
						}
					}
					has_global_flag = TR_USA_civil_war
					NOT = {
						has_global_flag = TR_USA_civil_war_finished
					}
				}
				if = {
					limit = {
						ROOT = {
							tag = FGA
						}
					}
					set_global_flag = TR_FGA_failed
				}
				if = {
					limit = {
						ROOT = {
							tag = CSA
						}
					}
					set_global_flag = TR_CSA_failed
					log = "TR_CSA_failed"
				}
				if = {
					limit = {
						ROOT = {
							tag = AMR
						}
					}
					set_global_flag = TR_AMR_failed
					log = "TR_AMR_failed"
				}
				if = {
					limit = {
						ROOT = {
							tag = ADR
						}
					}
					set_global_flag = TR_ADR_failed
					log = "TR_ADR_failed"
				}
				if = {
					limit = {
						ROOT = {
							tag = AMG
						}
					}
					set_global_flag = TR_AMG_failed
					log = "TR_AMG_failed"
				}
				if = {
					limit = {
						OR = {
							AND = {
								# has_global_flag = TR_FGA_failed
								has_global_flag = TR_CSA_failed
								has_global_flag = TR_AMR_failed
								has_global_flag = TR_ADR_failed
								has_global_flag = TR_AMG_failed
							}
							AND = {
								has_global_flag = TR_FGA_failed
								# has_global_flag = TR_CSA_failed
								has_global_flag = TR_AMR_failed
								has_global_flag = TR_ADR_failed
								has_global_flag = TR_AMG_failed
							}
							AND = {
								has_global_flag = TR_FGA_failed
								has_global_flag = TR_CSA_failed
								# has_global_flag = TR_AMR_failed
								has_global_flag = TR_ADR_failed
								has_global_flag = TR_AMG_failed
							}
							AND = {
								has_global_flag = TR_FGA_failed
								has_global_flag = TR_CSA_failed
								has_global_flag = TR_AMR_failed
								# has_global_flag = TR_ADR_failed
								has_global_flag = TR_AMG_failed
							}
							AND = {
								has_global_flag = TR_FGA_failed
								has_global_flag = TR_CSA_failed
								has_global_flag = TR_AMR_failed
								has_global_flag = TR_ADR_failed
								# has_global_flag = TR_AMG_failed
							}
						}
					}
					set_global_flag = TR_USA_civil_war_finished
					USA = {
						country_event = TR_super_event.6
					}
				}
			}
		}
	}
	on_state_control_changed = {
		effect = {
			if = { 
				limit = {
					has_global_flag = TR_risorgimento_war
					NOT = { has_global_flag = TR_risorgimento_war_finished }
					ROOT = {
						tag = SRI
					}
					FROM = {
						tag = ITA
						surrender_progress > 0.7
					}
				}
				SRI = {
					set_global_flag = SRI_one_Italy
					country_event = {
						id = TR_north_italy.4
						days = 5
					}
				}
			}
		}
	}
	on_weekly_SRI = {
		effect = {
			if = { 
				limit = {
					has_global_flag = TR_risorgimento_war
					NOT = { has_global_flag = TR_risorgimento_war_finished }
					ROOT = {
						tag = SRI
					}
					FROM = {
						tag = ITA
						surrender_progress > 0.75
					}
				}
				SRI = {
					set_global_flag = SRI_one_Italy
					country_event = TR_north_italy.4
				}
			}
		}
	}
}