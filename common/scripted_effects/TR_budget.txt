EV_update_taxes_ratio = {
	set_variable = {
		EV_taxes_ratio_slider_drager_position = EV_taxes_ratio_var
	}
	multiply_variable = {
		EV_taxes_ratio_slider_drager_position = 105
	}
	add_to_variable = {
		EV_taxes_ratio_slider_drager_position = 18
	}
	EV_update_taxes = yes
}
EV_update_taxes = {
	set_variable = {
		EV_taxes_amount_var_raw = num_of_civilian_factories_available_for_projects
	}
	add_to_variable = {
		EV_taxes_amount_var_raw = num_of_civilian_factories
	}
	divide_variable = {
		EV_taxes_amount_var_raw = 4
	}
	set_variable = {
		EV_mp = max_manpower_k
	}
	multiply_variable = {
		EV_mp = 0.08
	}
	multiply_variable = {
		EV_mp = 0.001
	}
	if = {
		limit = {
			check_variable = {
				EV_mp > 25
			}
		}
		multiply_variable = {
			EV_mp = 0.7
		}
	}
	if = {
		limit = {
			check_variable = {
				EV_mp > 20
			}
		}
		multiply_variable = {
			EV_mp = 0.7
		}
	}
	if = {
		limit = {
			check_variable = {
				EV_mp > 10
			}
		}
		multiply_variable = {
			EV_mp = 0.98
		}
	}
	if = {
		limit = {
			check_variable = {
				EV_mp > 9
			}
		}
		multiply_variable = {
			EV_mp = 0.98
		}
	}
	if = {
		limit = {
			check_variable = {
				EV_mp > 8
			}
		}
		multiply_variable = {
			EV_mp = 0.98
		}
	}
	if = {
		limit = {
			check_variable = {
				EV_mp > 7.5
			}
		}
		multiply_variable = {
			EV_mp = 0.95
		}
	}
	if = {
		limit = {
			check_variable = {
				EV_mp > 7
			}
		}
		multiply_variable = {
			EV_mp = 0.65
		}
	}
	if = {
		limit = {
			check_variable = {
				EV_mp > 6.5
			}
		}
		multiply_variable = {
			EV_mp = 0.7
		}
	}
	if = {
		limit = {
			check_variable = {
				EV_mp > 6
			}
		}
		multiply_variable = {
			EV_mp = 0.9
		}
	}
	if = {
		limit = {
			check_variable = {
				EV_mp > 5.5
			}
		}
		multiply_variable = {
			EV_mp = 0.95
		}
	}
	multiply_variable = {
		EV_taxes_amount_var_raw = EV_mp
	}
	multiply_variable = {
		EV_taxes_amount_var_raw = 0.087
	}
	set_variable = {
		EV_taxes_amount_var_k = EV_taxes_amount_var_raw
	}
	#1937年時点の日本の租税収入を基準とした値
	#単位は１００万ドル
	multiply_variable = {
		EV_taxes_amount_var_k = EV_taxes_ratio_var
	}
	add_to_variable = {#基本値
		EV_taxes_amount_var_k = 0.1
	}
	EV_update_gdp = yes
}
EV_update_social_security_ratio = {
	set_variable = {
		EV_social_security_slider_drager_position = EV_social_security_var
	}
	multiply_variable = {
		EV_social_security_slider_drager_position = 105
	}
	add_to_variable = {
		EV_social_security_slider_drager_position = 18
	}
	EV_update_social_security = yes
}
EV_update_social_security = {
	set_temp_variable = {
		var = temp_mp
		value = max_manpower_k
	}
	multiply_temp_variable = {
		var = temp_mp
		value = 0.001
	}
	multiply_temp_variable = {
		var = temp_mp
		value = 0.001
	}
	set_temp_variable = {
		var = temp_gdp
		value = GDP_amount_var
	}
	divide_temp_variable = {
		var = temp_gdp
		value = 200
	}
	add_to_temp_variable = {
		var = temp_mp
		value = temp_gdp
	}
	multiply_temp_variable = {
		var = temp_mp
		value = -1
	}
	multiply_temp_variable = {
		var = temp_mp
		value = EV_social_security_var
	}
	set_variable = {
		var = EV_social_security_amount_var
		value = temp_mp
	}
}
EV_update_war_expenses_ratio = {
	set_variable = {
		EV_war_expenses_slider_drager_position = EV_war_expenses_var_raw
	}
	multiply_variable = {
		EV_war_expenses_slider_drager_position = 105
	}
	add_to_variable = {
		EV_war_expenses_slider_drager_position = 18
	}
	EV_update_war_expenses = yes
}
EV_update_war_expenses = {
	#EV_war_expenses_amount_var
	#EV_war_expenses_var
	set_variable = {
		infantry_n = num_battalions_with_type@infantry
	}
	set_variable = {
		artillery_n = num_battalions_with_type@artillery
	}
	set_variable = {
		cavalry_n = num_battalions_with_type@cavalry
	}
	set_variable = {
		motorized_n = num_battalions_with_type@motorized
	}
	set_variable = {
		light_armor_n = num_battalions_with_type@light_armor
	}
	set_variable = {
		medium_armor_n = num_battalions_with_type@medium_armor
	}
	set_temp_variable = {
		temp_infantry_a = num_equipment_in_armies_k@infantry
	}
	set_temp_variable = {
		temp_infantry_t = num_target_equipment_in_armies_k@infantry
	}
	set_variable = {
		suff_infantry = temp_infantry_a
	}
	divide_variable = {
		suff_infantry = temp_infantry_t
	}
	set_temp_variable = {
		temp_artillery_a = num_equipment_in_armies_k@artillery
	}
	set_temp_variable = {
		temp_artillery_t = num_target_equipment_in_armies_k@artillery
	}
	set_variable = {
		suff_artillery = temp_artillery_a
	}
	divide_variable = {
		suff_artillery = temp_artillery_t
	}
	set_temp_variable = {
		temp_cavalry_a = num_equipment_in_armies_k@cavalry
	}
	set_temp_variable = {
		temp_cavalry_t = num_target_equipment_in_armies_k@cavalry
	}
	set_variable = {
		suff_cavalry = temp_cavalry_a
	}
	divide_variable = {
		suff_cavalry = temp_cavalry_t
	}
	set_temp_variable = {
		temp_motorized_a = num_equipment_in_armies_k@motorized
	}
	set_temp_variable = {
		temp_motorized_t = num_target_equipment_in_armies_k@motorized
	}
	set_variable = {
		suff_motorized = temp_motorized_a
	}
	divide_variable = {
		suff_motorized = temp_motorized_t
	}
	set_temp_variable = {
		temp_light_armor_a = num_equipment_in_armies_k@light_armor
	}
	set_temp_variable = {
		temp_light_armor_t = num_target_equipment_in_armies_k@light_armor
	}
	set_variable = {
		suff_light_armor = temp_light_armor_a
	}
	divide_variable = {
		suff_light_armor = temp_light_armor_t
	}
	set_temp_variable = {
		temp_medium_armor_a = num_equipment_in_armies_k@medium_armor
	}
	set_temp_variable = {
		temp_medium_armor_t = num_target_equipment_in_armies_k@medium_armor
	}
	set_variable = {
		suff_medium_armor = temp_medium_armor_a
	}
	divide_variable = {
		suff_medium_armor = temp_medium_armor_t
	}
	set_variable = {
		other = num_battalions
	}
	subtract_from_variable = {
		other = infantry_n
	}
	subtract_from_variable = {
		other = artillery_n
	}
	subtract_from_variable = {
		other = cavalry_n
	}
	subtract_from_variable = {
		other = motorized_n
	}
	subtract_from_variable = {
		other = light_armor_n
	}
	subtract_from_variable = {
		other = medium_armor_n
	}
	set_variable = {
		armies_cost = 0
	}
	set_variable = {
		infantry_cost = infantry_n
	}
	multiply_variable = {
		infantry_cost = suff_infantry
	}
	multiply_variable = {
		infantry_cost = 1
	}
	set_variable = {
		artillery_cost = artillery_n
	}
	multiply_variable = {
		artillery_cost = suff_artillery
	}
	multiply_variable = {
		artillery_cost = 1.5
	}
	set_variable = {
		cavalry_cost = cavalry_n
	}
	multiply_variable = {
		cavalry_cost = suff_cavalry
	}
	multiply_variable = {
		cavalry_cost = 1.2
	}
	set_variable = {
		motorized_cost = motorized_n
	}
	multiply_variable = {
		motorized_cost = suff_motorized
	}
	multiply_variable = {
		motorized_cost = 1.5
	}
	set_variable = {
		light_armor_cost = light_armor_n
	}
	multiply_variable = {
		light_armor_cost = suff_light_armor
	}
	multiply_variable = {
		light_armor_cost = 2
	}
	set_variable = {
		medium_armor_cost = medium_armor_n
	}
	multiply_variable = {
		medium_armor_cost = suff_medium_armor
	}
	multiply_variable = {
		medium_armor_cost = 3
	}
	set_variable = {
		other_cost = other_n
	}
	multiply_variable = {
		other_cost = 1
	}
	add_to_variable = {
		armies_cost = other_cost
	}
	add_to_variable = {
		armies_cost = infantry_cost
	}
	add_to_variable = {
		armies_cost = artillery_cost
	}
	add_to_variable = {
		armies_cost = cavalry_cost
	}
	add_to_variable = {
		armies_cost = motorized_cost
	}
	add_to_variable = {
		armies_cost = light_armor_cost
	}
	add_to_variable = {
		armies_cost = medium_armor_cost
	}
	set_variable = {
		war_ex = 0.1
	}
	add_to_variable = {
		war_ex = EV_war_expenses_var_raw
	}
	multiply_variable = {
		armies_cost = war_ex
	}
	# multiply_variable = {
	# 	armies_cost = 0.087
	# }
	set_variable = {
		EV_war_expenses_amount_var = armies_cost
	}
	EV_update_gdp = yes
}
EV_update_gdp = {
	set_variable = {
		GDP_amount_var = 0
	}
	set_variable = {
		var = GDP_civilian
		value = EV_taxes_amount_var_raw
	}
	divide_variable = {
		var = GDP_civilian
		value = 7
	}
	multiply_variable = {
		var = GDP_civilian
		value = 365
	}
	set_variable = {
		var = GDP_army
		value = num_of_military_factories
	}
	add_to_variable = {
		var = GDP_army
		value = num_of_naval_factories
	}
	divide_variable = {
		var = GDP_army
		value = 4
	}
	multiply_variable = {
		var = GDP_army
		value = 4.536
	}
	set_variable = {
		var = GDP_government
		value = EV_war_expenses_amount_var
	}
	divide_variable = {
		var = GDP_government
		value = 7
	}
	multiply_variable = {
		var = GDP_government
		value = -365
	}
	add_to_variable = {
		var = GDP_amount_var
		value = GDP_civilian
	}
	add_to_variable = {
		var = GDP_amount_var
		value = GDP_army
	}
	add_to_variable = {
		var = GDP_amount_var
		value = GDP_government
	}
}
EV_update_gdp_to_line = {
	# 折れ線グラフを更新する

	# This count is displayed as an x-axis label, increment it
	add_to_variable = { GDP_count = 1 }
	
	set_variable = {
		GDP_last_amount = GDP_amount
	}
	set_variable = {
		GDP_amount = GDP_amount_var
	}
	clear_array = GDP_relatives
	clear_array = GDP_graph_offsets
	clear_array = GDP_graph_slopes
	add_to_array = {
		array = GDP_amounts
		value = GDP_amount
	}
	for_each_loop = {
		array = GDP_amounts
		value = v
		index = i
		add_to_array = {
			array = GDP_relatives
			value = v
		}
		divide_variable = {
			GDP_relatives^i = GDP_amount
		}
	}
	for_each_loop = {
		array = GDP_relatives
		value = v
		index = i
		add_to_array = {
			array = GDP_graph_offsets
			value = v
		}
		multiply_variable = {
			GDP_graph_offsets^i = -100
		}
		add_to_variable = {
			GDP_graph_offsets^i = 0
		}
	}
	for_each_loop = {
		array = GDP_graph_offsets
		value = v
		index = i
		set_temp_variable = {
			bi = i 
		}
		add_to_temp_variable = {
			bi = 1
		}
		add_to_array = {
			array = GDP_graph_slopes
			value = v
		}
		if = {
			limit = {
				NOT = {
					check_variable = {
						GDP_graph_offsets^bi = 0
					}
				}
			}
			subtract_from_variable = {
				GDP_graph_slopes^i = GDP_graph_offsets^bi
			}
		}
		else = {
			subtract_from_variable = {
				GDP_graph_slopes^i = GDP_graph_offsets^i
			}
		}
		divide_variable = {
			GDP_graph_slopes^i = 4.14
		}
		add_to_variable = {
			GDP_graph_slopes^i = 50
		}
		set_variable = {
			gdp_50pct = GDP_amounts^i
		}
	}
	# 範囲外のものを削除
	if = {
		limit = {
			check_variable = { GDP_count > 40 }
		}
		remove_from_array = { array = GDP_amounts index = 0 }
		remove_from_array = { array = GDP_relatives index = 0 }
		remove_from_array = { array = GDP_graph_offsets index = 0 }
		remove_from_array = { array = GDP_graph_slopes index = 0 }
	}
	
	set_variable = {
		gdp_100pct = gdp_50pct
	}
	multiply_variable = {
		gdp_100pct = 1.5
	}
	set_variable = {
		gdp_90pct = gdp_50pct
	}
	multiply_variable = {
		gdp_90pct = 1.4
	}
	set_variable = {
		gdp_80pct = gdp_50pct
	}
	multiply_variable = {
		gdp_80pct = 1.3
	}
	set_variable = {
		gdp_70pct = gdp_50pct
	}
	multiply_variable = {
		gdp_70pct = 1.2
	}
	set_variable = {
		gdp_60pct = gdp_50pct
	}
	multiply_variable = {
		gdp_60pct = 1.1
	}
	set_variable = {
		gdp_40pct = gdp_50pct
	}
	multiply_variable = {
		gdp_40pct = 0.9
	}
	set_variable = {
		gdp_30pct = gdp_50pct
	}
	multiply_variable = {
		gdp_30pct = 0.8
	}
	set_variable = {
		gdp_20pct = gdp_50pct
	}
	multiply_variable = {
		gdp_20pct = 0.7
	}
	set_variable = {
		gdp_10pct = gdp_50pct
	}
	multiply_variable = {
		gdp_10pct = 0.6
	}
	set_variable = {
		gdp_0pct = gdp_50pct
	}
	multiply_variable = {
		gdp_0pct = 0.5
	}
}
BUDGET_LOG = {
	log = "[?global.date.GetDateStringNoHour]"
	log = "BUDGET_LOG1"
	log = "BUDGET_LOG2"
	log = "BUDGET_LOG3"
	log = "BUDGET_LOG4"
	log = "BUDGET_LOG5"
	log = "BUDGET_LOG6"
	log = "BUDGET_LOG7"
	log = "BUDGET_LOG8"
	log = "BUDGET_LOG9"
}
d_BUDGET_LOG = {
	BUDGET_LOG = yes
}